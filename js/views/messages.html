<div class="page-header">
  <h2>Messages</h2>
  <div class="btn-group pull-right">
    <button type="submit" 
            ng-click="composeMessage()" 
            class="btn btn-success {{(views.compose==true) && 'active'}}">Compose a message</button>
  </div>
</div>



<!-- Messages toolbar -->
<!-- <div class="row" style="padding-left: 30px;">
  <div class="btn-group" style="margin-left: 15px" bs-buttons-radio>
    <button type="button" class="btn" ng-model="boxes.inbox">Inbox</button>
    <button type="button" class="btn" ng-model="boxes.outbox">Outbox</button>
    <button type="button" class="btn" ng-model="boxes.trash">Trash</button>
  </div>
  <hr>
</div> -->
<!-- end of messages toolbar -->













<!-- inboxes -->
<div class="row-fluid">
  <div class="tabbable tabs-left">
    
    <!-- tabs -->
    <ul class="nav nav-tabs nav-tabs-app">

      <li class="{{(views.compose==true) && 'active'}}" ng-show="views.compose">
        <a href="#composeTab" 
            data-toggle="tab"
            ng-click="fixTabHeight('composeTab')"><span class="entypo">&#9998;</span> Compose</a>
      </li>

      <li class="{{(views.message==true) && 'active'}}"  ng-show="views.message">
        <a href="#viewTab" 
            data-toggle="tab"
            ng-click="fixTabHeight('viewTab')"><span class="entypo">&#128196;</span> Message</a>
      </li>

      <li class="{{(views.default==true) && 'active'}}">
        <a href="#inboxTab" 
            data-toggle="tab"
            ng-click="fixTabHeight('inboxTab'); resetViews()"><span class="entypo">&#128229;</span> Inbox</a>
      </li>

      <li>
        <a href="#outboxTab" 
            data-toggle="tab"
            ng-click="fixTabHeight('outboxTab'); resetViews()"><span class="entypo">&#128228;</span> Outbox</a>
      </li>

      <li>
        <a href="#trashTab" 
            data-toggle="tab"
            ng-click="fixTabHeight('trashTab'); resetViews()"><span class="entypo">&#9749;</span> Trash</a>
      </li>

    </ul>
    <!-- end tabs -->





    <!-- tabs content -->
    <div class="tab-content">

      



      <!-- composeTab -->
      <div class="tab-pane active" id="composeTab" ng-show="views.compose">

        <div class="tab-header">
          <h3 class="pull-left">Compose message</h3>
        </div>
        <hr>

        <form>
          <fieldset>
        
            <div class="control-group">
              <label>Broadcast</label>
              <div  class="btn-group"  
                    bs-buttons-checkbox="" 
                    data-toggle="buttons-checkbox">

                <button type="button" 
                        class="btn" 
                        ng-model="message.type.sms" 
                        ng-click=""
                        bs-button="">SMS</button>

                <button type="button" 
                        class="btn" 
                        ng-model="message.type.email" 
                        ng-click=""
                        bs-button="">Email</button>
              </div>
            </div>

            <div class="control-group">
              <label>Receviers</label>
              <select data-placeholder="Choose a Recipient" 
                      multiple class="span5 chzn-select" 
                      chosen
                      ng-model="message.receivers" 
                      ng-options="receiver.name group by receiver.group for receiver in receviersList">
              </select>
      <!--         <p ng-repeat="receiver in message.receivers"><strong>{{receiver.id}}</strong></p> -->
            </div>

            <div class="control-group">
              <label>Subject</label>
              <input type="text" 
                      class="span5"
                      ng-model="message.subject"
                      placeholder="Type a subjectâ€¦">
            </div>


            <div class="control-group">
              <label>Message</label>
              <textarea rows="7" 
                        class="span7"
                        ng-model="message.body"></textarea>
            </div>

            <hr>

            <button type="submit" 
                    ng-click="sendMessage(message)" 
                    class="btn btn-success">Send Message</button>

            <button type="submit" 
                    ng-click="composeCancel()" 
                    class="btn">Cancel</button>

          </fieldset>
        </form>

      </div>
      <!-- end composeTab -->






      
      <!-- viewTab -->
      <div class="tab-pane {{(views.message==true) && 'active'}}" id="viewTab" ng-show="views.message">

        <div class="tab-header">
          <h3 class="pull-left">Message</h3>
        </div>
        <hr>

        <dl>
          <dt>Sender</dt>
            <dd>{{message.sender}}</dd>
          <dt>Receiver</dt>
            <dd>{{message.receiver}}</dd>
          <dt>Date</dt>
            <dd>{{message.datetime}}</dd>
          <dt>Module</dt>
            <dd>{{message.module}}</dd>
          <dt>Priority</dt>
            <dd>{{message.priority}}</dd>
          <dt>Question Text</dt>
            <dd>{{message.question_text}}</dd>
          <dt>State</dt>
            <dd>{{message.state}}</dd>
          <dt>Subject</dt>
            <dd>{{message.subject}}</dd>
          <dt>Type</dt>
            <dd>{{message.type}}</dd>
        </dl>


      </div>
      <!-- end composeTab -->







      
      <!-- inboxTab -->
      <div class="tab-pane {{(views.default==true) && 'active'}}" id="inboxTab">

        <div class="tab-header">
          <h3 class="pull-left">Inbox</h3>
        </div>
        <hr>

        <p ng-hide="messages.inbox.length > 0">There are no messages in inbox.</p>

        <div ng-show="messages.inbox.length > 0">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>
                  <input type="checkbox"
                          ng-model="selectionMaster"
                          ng-click="toggleSelection(group, selectionMaster)">
                </th>
                <th>Subject</th>
                <th>Date</th>
                <th>State</th>
                <th></th>
              </tr>
            </thead>
            <tbody>

              <tr ng-repeat="message in messages.inbox">
                <td>
                  <input type="checkbox"
                          ng-model="selection[member.uuid]"
                          ng-checked="selectionMaster">
                </td>
                <td><a href="#/messages/{{message.uuid}}">{{message.subject}}</a></td>
                <td>{{message.creationTime}}</td>
                <td>{{message.state}}</td>
                <td>
                  <div class="pull-right">
                  
                    <a href="#/profile/{{member.uuid}}/edit" 
                      class="btn btn-mini"><i class="icon-share-alt"></i></a>

                    <button type="submit" 
                            ng-click="removeMember(member.uuid, group.uuid)" 
                            class="btn btn-danger btn-mini"><i class="icon-trash icon-white"></i></button>

                  </div>
                </td>
              </tr>

            </tbody>
          </table>

          <button type="button" 
                  ng-click="removeMembers(selection, group)" 
                  class="btn btn-small btn-danger pull-left">
                  <i class="icon-trash icon-white"></i> Remove Selected Members</button>

          <span class="muted pull-right">
            <small><i>There are {{members[group.uuid].length}} member(s)</i></small>
          </span>
        </div>

      </div>
      <!-- end inboxTab -->






      <!-- outboxTab -->
      <div class="tab-pane" id="outboxTab">

        <div class="tab-header">
          <h3 class="pull-left">Outbox</h3>
        </div>
        <hr>

        <p ng-hide="messages.outbox.length > 0">There are no messages in outbox.</p>

        <div ng-show="messages.outbox.length > 0">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>
                  <input type="checkbox"
                          ng-model="selectionMaster"
                          ng-click="toggleSelection(group, selectionMaster)">
                </th>
                <th>Subject</th>
                <th>Date</th>
                <th>State</th>
                <th></th>
              </tr>
            </thead>
            <tbody>

              <tr ng-repeat="message in messages.outbox">
                <td>
                  <input type="checkbox"
                          ng-model="selection[member.uuid]"
                          ng-checked="selectionMaster">
                </td>
                <td><a href="#/profile/{{member.uuid}}/view">{{message.subject}}</a></td>
                <td>{{message.creationTime}}</td>
                <td>{{message.state}}</td>
                <td>
                  <div class="pull-right">

                    <a href="#/profile/{{member.uuid}}/edit" 
                      class="btn btn-mini"><i class="icon-share-alt"></i></a>

                    <button type="submit" 
                            ng-click="removeMember(member.uuid, group.uuid)" 
                            class="btn btn-danger btn-mini"><i class="icon-trash icon-white"></i></button>

                  </div>
                </td>
              </tr>

            </tbody>
          </table>

          <button type="button" 
                  ng-click="removeMembers(selection, group)" 
                  class="btn btn-small btn-danger pull-left">
                  <i class="icon-trash icon-white"></i> Remove Selected Members</button>

          <span class="muted pull-right">
            <small><i>There are {{members[group.uuid].length}} member(s)</i></small>
          </span>
        </div>

      </div>
      <!-- end outboxTab -->









      <!-- trashTab -->
      <div class="tab-pane" id="trashTab">

        <div class="tab-header">
          <h3 class="pull-left">Trash</h3>
        </div>
        <hr>

        <p ng-hide="messages.outbox.length > 0">There are no messages in outbox.</p>

        <div ng-show="messages.outbox.length > 0">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>
                  <input type="checkbox"
                          ng-model="selectionMaster"
                          ng-click="toggleSelection(group, selectionMaster)">
                </th>
                <th>Subject</th>
                <th>Date</th>
                <th>State</th>
                <th></th>
              </tr>
            </thead>
            <tbody>

              <tr ng-repeat="message in messages.outbox">
                <td>
                  <input type="checkbox"
                          ng-model="selection[member.uuid]"
                          ng-checked="selectionMaster">
                </td>
                <td><a href="#/profile/{{member.uuid}}/view">{{message.subject}}</a></td>
                <td>{{message.creationTime}}</td>
                <td>{{message.state}}</td>
                <td>
                  <div class="pull-right">

                    <a href="#/profile/{{member.uuid}}/edit" 
                      class="btn btn-mini"><i class="icon-share-alt"></i></a>

                    <button type="submit" 
                            ng-click="removeMember(member.uuid, group.uuid)" 
                            class="btn btn-danger btn-mini"><i class="icon-trash icon-white"></i></button>

                  </div>
                </td>
              </tr>

            </tbody>
          </table>

          <button type="button" 
                  ng-click="removeMembers(selection, group)" 
                  class="btn btn-small btn-danger pull-left">
                  <i class="icon-trash icon-white"></i> Remove Selected Members</button>

          <span class="muted pull-right">
            <small><i>There are {{members[group.uuid].length}} member(s)</i></small>
          </span>
        </div>

      </div>
      <!-- end trashTab -->

    </div>
    <!-- end tabs content -->

  </div>
</div>
<!-- end inboxes -->








































<!-- messages list -->
<!-- 
<div class="tabbable tabs-left"
      ng-show="listview">

  <ul class="nav nav-tabs" 
      style="width: 210px;
              height: 600px;
              overflow: hidden;
              margin-right: -1px">
    <li ng-repeat="message in messages" 
    		class="{{($index == 0) && 'active'}}">

    	<a href="#msg-{{message.uuid}}" 
          data-toggle="tab"
          ng-click="fixTabHeight(message.uuid)">
    		<strong>{{message.sender}}</strong><br>
    		{{message.subject}}<br>
    		{{message.creationTime}}
    	</a>
    	
    	
    </li>
  </ul>

  <div class="tab-content"
        style="background-color: white; 
                border: 1px solid #ddd; 
                padding: 20px;
                height: 600px">
  

    <div ng-repeat="message in messages"
    			class="{{($index == 0) && 'tab-pane active' || 'tab-pane'}}"
    			id="msg-{{message.uuid}}">

      <div style="overflow: hidden; height: 35px">
        <h3 style="margin-top: 0;" class="pull-left">{{message.subject}}</h3>

	        <div class="pull-right">
	          <button type="submit" ng-show="boxes.inbox"
	                  ng-click="replyMessage(message)" class="btn">Reply</button>
	       	  <button type="button" ng-show="boxes.inbox || boxes.outbox"
	                  class="btn btn-danger" ng-click="askDelete(message)" 
	                  bs-modal="'partials/modal.html'" >Delete</button>
	          <button type="submit" ng-show="boxes.trash"
	                  ng-click="restore(message)" 
	                  class="btn ">Restore</button>
	          <button type="submit" ng-show="boxes.trash"
	                  ng-click="askDeleteforever(message)" 
	                  class="btn btn-danger" bs-modal="'partials/modal.html'" >Delete Forever</button>
	        </div>
        
      </div>
      

      <hr>
    
    </div>
  </div>

</div>
<!-- end messages list -->







<!-- Trash view --> 
<!-- 
<div ng-show="trashview" ng-hide="listview">
	
<div>
	<div class="pull-right">
		<button type="button"
		ng-click="restoreSelectedMsg()"
		class="btn">
			<i class="icon-edit icon-white"></i> Restore
		</button>
		<button type="button"
		ng-click="deleteSelectedMsg()"
		class="btn btn-danger">
			<i class="icon-trash icon-white"></i> Delete Forever
		</button>
		<button type="button"
		ng-click="emptyMsgTrash()"
		class="btn btn-warning">
			<i class="icon-trash icon-white"></i> Empty Trash
		</button>
	</div>
	<!-- <button type="button"
	ng-click=""
	style="margin-right: 15px"
	class="btn btn-success pull-right"><i class="icon-plus icon-white"></i> Add Members</button> -->

  <!-- 
</div>
<p ng-hide="messages.length > 0">
	Trash is empty. 
</p>
<div ng-show="messages.length > 0">
	<table class="table table-striped">
		<thead>
			<tr>
				<th>
				<input type="checkbox"
				ng-model="selectionMaster"
				ng-click="toggleSelection(selectionMaster)">
				</th>
				<th>Subject</th>
				<th>Sender</th>
				<th>Receiver</th>
				<th>Date</th>
			</tr>
		</thead>
		<tbody>
			<tr ng-repeat="message in messages">
				<td>
				<input type="checkbox"
				ng-model="selection[message.uuid]"
				ng-checked="selectionMaster">
				</td>
				<td><a href="#/message/{{message.uuid}}/view">{{message.subject}}</a></td>
				<td><span wp-name="message.requester | eveURL2Id"></span></td>
				<td>
					<ul>
						<li ng-repeat="rec in message.responder">
							<span wp-name="rec | eveURL2Id">
						</li>
					</ul>
				</td>
				<td>{{message.creationTime | nicelyDate}}</td>
				<td>
					 <div class="pull-right">
				          <button type="submit" ng-show="boxes.trash"
				                  ng-click="restore(message)" 
				                  class="btn ">Restore</button>
				          <button type="submit" ng-show="boxes.trash"
				                  ng-click="askDeleteforever(message)" 
				                  class="btn btn-danger " bs-modal="'partials/modal.html'" >
				                  <i class="icon-trash icon-white"></i></button>
			          </div>
				</td>
			</tr>
		</tbody>
	</table>
	
	<span class="muted pull-right"><i>There are {{messages.length}} message(s)</i></span>
</div>

</div>
     


<!-- end Trash view -->

















